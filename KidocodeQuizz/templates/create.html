<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Quiz</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 20px;
            padding: 20px;
            text-align: center;
            background-color: #f4f4f4;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #222;
            color: white;
            padding: 15px;
            border-radius: 10px;
        }
        .header button {
            background: red;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
        }
        .container {
            max-width: 700px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        .quiz-title {
            font-size: 24px;
            padding: 10px;
            width: 90%;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .question {
            background: #fff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
        }
        .add-question-btn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .question-type-container {
            display: none;
            margin-top: 10px;
        }
        select, input[type="text"], input[type="file"] {
            width: 80%;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .add-remove-btns {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Create a Quiz</h1>
        <div>
            <button onclick="window.location.href='quizzes.html'">Exit</button>
            <button onclick="saveQuiz()">Save</button>
        </div>
    </div>
    
    <div class="container">
        <input type="text" id="quizTitle" class="quiz-title" placeholder="Enter quiz title...">
        <div id="questionContainer"></div>
        <button onclick="toggleQuestionTypeMenu()" class="add-question-btn">Add Question</button>
        <div class="question-type-container" id="questionTypeContainer">
            <label for="questionType">Select Question Type:</label>
            <select id="questionType" onchange="addSelectedQuestion()">
                <option value="">-- Select --</option>
                <option value="single">Single Choice</option>
                <option value="multi">Multiple Choice</option>
                <option value="typing">Typing Answer</option>
            </select>
        </div>
    </div>    

    <script>
        let questions = [];

        function toggleQuestionTypeMenu() {
            let menu = document.getElementById("questionTypeContainer");
            menu.style.display = menu.style.display === "block" ? "none" : "block";
        }

        function addSelectedQuestion() {
            let type = document.getElementById("questionType").value;
            if (type) {
                addQuestion(type);
                document.getElementById("questionType").value = "";
                document.getElementById("questionTypeContainer").style.display = "none";
            }
        }

        function addQuestion(type) {
            let questionID = `q${questions.length + 1}`;
            let questionHTML = `
                <div class="question" id="${questionID}">
                    <input type="text" placeholder="Enter Question Text" class="quiz-title">
                    <input type="file" onchange="uploadMedia(event, '${questionID}')">
                    <div class="answers" id="answers-${questionID}">
                        ${generateAnswerFields(questionID, type)}
                    </div>
                    <div class="add-remove-btns">
                        <button onclick="addOption('${questionID}', '${type}')">Add Option</button>
                        <button onclick="removeQuestion('${questionID}')">Remove</button>
                    </div>
                </div>
            `;
            document.getElementById("questionContainer").innerHTML += questionHTML;
            questions.push({ questionID, type, answers: [] });
        }

        function generateAnswerFields(id, type) {
            if (type === 'typing') {
                return `<div class="option"><input type="text" placeholder="Correct Answer"></div>`;
            } else if (type === 'single') {
                return `
                    <div>
                        <input type="text" placeholder="Option 1"> <input type="radio" name="answer-${id}">
                        <input type="text" placeholder="Option 2"> <input type="radio" name="answer-${id}">
                    </div>
                `;
            } else {
                return `
                    <div>
                        <input type="text" placeholder="Option 1"> <input type="checkbox">
                        <input type="text" placeholder="Option 2"> <input type="checkbox">
                    </div>
                `;
            }
        }

        function addOption(questionID, type) {
            let answerContainer = document.getElementById(`answers-${questionID}`);
            let newOption = document.createElement("div");
            newOption.classList.add("option");

            let optionInput = document.createElement("input");
            optionInput.type = "text";
            optionInput.placeholder = "New Option"; // Updated placeholder

            let checkbox;
            if (type === "multi") {
                checkbox = document.createElement("input");
                checkbox.type = "checkbox";
            } else if (type === "single") {
                checkbox = document.createElement("input");
                checkbox.type = "radio";
                checkbox.name = `answer-${questionID}`;
            }

            let removeBtn = document.createElement("button");
            removeBtn.innerText = "Remove";
            removeBtn.onclick = function () {
                newOption.remove();
            };

            newOption.appendChild(optionInput);
            if (checkbox) newOption.appendChild(checkbox);
            newOption.appendChild(removeBtn);

            answerContainer.appendChild(newOption);
        }

        function removeQuestion(questionID) {
            let questionElement = document.getElementById(questionID);
            if (questionElement) {
                questionElement.remove();
                questions = questions.filter(q => q.questionID !== questionID);
            }
        }
    </script>
</body>
</html>
